# RAG SDK Structure&Function

***

## 1.RAG SDK架构

![img](https://cdn.jsdelivr.net/gh/kiu795/pic@main/img/1763600632.png)

**RAG SDK应用套件**

- **核心定位**：整个结构的最高层，代表一个**端到端的RAG开发工具包**，旨在简化大模型应用（如问答、知识库增强）的构建流程。
- **关键作用**
  - 提供标准化接口，将底层硬件/框架与上层应用解耦，使开发者（如您做Agentic RAG in Pyterrier时）能专注于业务逻辑。
  - 整合RAG全流程能力（检索、生成、评估），避免重复造轮子。

**RAG Python API**

- **核心定位**：SDK的**核心接口层**，提供Python编程接口，封装RAG的核心功能模块。这是开发者（如您）直接交互的层面。

- **整体价值**：
  此层是RAG应用的“大脑”，将复杂技术封装为简单API。

**大模型应用推理加速**

- **核心定位**：**性能优化层**，专注于提升大模型生成阶段的速度和资源效率。这是RAG中“生成”部分的关键加速器。
- **子模块解析**：
  - Reference 自投机推理
    - 作用：通过参考历史推理结果，减少重复计算（例如：缓存相似prompt的中间状态）。
    - 技术：基于KV Cache优化，避免重复计算注意力矩阵。
    - 关联：您的Agentic RAG若涉及多次迭代（如智能体反复查询），此技术可降低延迟。
  - Topk并行推理
    - 作用：并行处理Top-k采样中的多个候选token，加速生成过程。
    - 技术：利用GPU并行性，同时计算多个token的生成概率。
    - 关联：在Agentic RAG中，生成工具调用参数时需快速Top-k采样，此模块可提升响应速度。
  - Prompt压缩
    - 作用：精简输入prompt长度，减少计算量。
    - 技术：通过摘要模型或规则过滤冗余信息（例如：只保留关键上下文）。
    - 关联：您的RAG系统若处理长文档（如论文），此技术可避免token超限，尤其对Pyterrier的检索结果预处理有用。
- **整体价值**：
  RAG中“生成”阶段常是瓶颈。此层直接解决您的痛点——**大模型应用需实时性**。例如，在Agentic RAG中，智能体调用工具后需快速生成回复，推理加速确保低延迟。

**推理框架**：

- **核心定位**：**执行引擎层**，提供具体的推理框架实现，将抽象加速策略落地到代码。
- **整体价值**：此层是推理加速的“落地载体”，实现端到端加速。

**应用加速算子层**

- **核心定位**：**硬件抽象层**，提供定制化算子（Operators）优化计算性能。
- 关键说明
  - 作用：将上层框架（如VLLM）的请求转换为硬件友好的计算指令，例如：优化矩阵乘法、注意力机制等核心算子。
  - 技术：基于CUDA或昇腾CANN编写算子，针对RAG场景（如向量检索）定制加速。

**CANN**

- **核心定位**：**昇腾硬件的计算架构层**，华为专有技术。
- 关键作用
  - 提供昇腾AI处理器的底层支持，包括算子库、编译器和运行时。
  - 实现“硬件感知优化”：例如，将向量检索的计算任务分配到昇腾芯片的AI Core上。

**昇腾硬件**

- **核心定位**：**物理硬件层**，提供算力基础。
- 关键说明
  - 昇腾（Ascend）是华为的AI芯片系列（如Ascend 910），专为深度学习设计。
  - 作用：执行所有计算任务，包括向量化、检索、生成等。



RAG应用结构

![image-20251120162410325](C:/Users/50327/AppData/Roaming/Typora/typora-user-images/image-20251120162410325.png)

